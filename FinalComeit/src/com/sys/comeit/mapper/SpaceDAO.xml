<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.sys.comeit.ISpaceDAO">

<!-- 공간 상세페이지 -->
   <!-- 공간 정보 조회 -->
	<select id="spaceInfoSearch" resultType="com.sys.comeit.SpaReqDTO">
		SELECT ID, SPA_CD, SPA_REQ_CD, SPA_NAME, TYPE_NAME, BUSI_NAME, RPRSN_NAME, STR_TIME, END_TIME, USE_HRS, ONE_INTRO, AREA_NAME, SPC_AREA_NAME,RSV_NOTES,DTL_INTRO 
		(     
		SELECT COUNT(*)
		FROM VIEW_SPA_FEEDCOUNT 
		WHERE SPA_REQ_CD=M.SPA_REQ_CD
		) AS FEEDCOUNT
		FROM VIEW_SPA_MY M
		WHERE SPA_REQ_CD = #{spa_req_cd}
   </select>

	<!-- 공간 관심 태그 조회 -->
	<select id="spaceTagSearch" resultType="com.sys.comeit.SpaReqDTO">
	 SELECT SPA_REQ_CD, TAG_NAME
	 FROM VIEW_SPA_TAG
	 UNION ALL
	 SELECT SPA_REQ_CD, ETC_TAG
	 FROM VIEW_SPA_ETC_TAG
	 WHERE SPA_REQ_CD = #{spa_req_cd}
   </select>
	

<!-- 공간 리스트 -->
<!-- SELECT ID, SPA_CD, SPA_REQ_CD, SPA_NAME, TYPE_NAME, BUSI_NAME, RPRSN_NAME, STR_TIME, END_TIME, USE_HRS, ONE_INTRO, AREA_NAME, SPC_AREA_NAME
      FROM VIEW_SPA_MY
      WHERE CHECK_TYPE_CD LIKE #{check_type} -->
   <!-- 전체 공간 조회 & 피드백수 -->
   <select id="spaceList" resultType="com.sys.comeit.SpaReqDTO">
		SELECT ID, SPA_CD, SPA_REQ_CD, SPA_NAME, TYPE_NAME, BUSI_NAME, RPRSN_NAME, STR_TIME, END_TIME, USE_HRS, ONE_INTRO, AREA_NAME, SPC_AREA_NAME,     
		(     
		SELECT COUNT(*)
		FROM VIEW_SPA_FEEDCOUNT 
		WHERE SPA_REQ_CD=M.SPA_REQ_CD
		) AS FEEDCOUNT
		FROM VIEW_SPA_MY M
		WHERE CHECK_TYPE_CD LIKE #{check_type}
   </select>
   
   
   <!-- 전체 공간 개수 조회 -->
   <select id="spaceCount" resultType="java.lang.Integer">
      <![CDATA[
      SELECT COUNT(*) AS COUNT
      FROM VIEW_SPA_MY
      WHERE CHECK_TYPE_CD LIKE #{check_type}
      ]]>
   </select>
   
   <!-- 모든 공간 각 관심 키워드 -->
   <select id="spaceTagList" resultType="com.sys.comeit.SpaReqDTO">
	 SELECT SPA_REQ_CD, TAG_NAME
	 FROM VIEW_SPA_TAG
	 UNION ALL
	 SELECT SPA_REQ_CD, ETC_TAG
	 FROM VIEW_SPA_ETC_TAG
   </select>
   
</mapper>