<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.sys.comeit.IAdminDAO">
	
	<!-- 관리자 정보 조회 list() -->
	<select id="adminList" resultType="com.sys.comeit.AdminDTO">
		SELECT  A.NAME AS NAME ,  A.ADMIN_CD AS ADMIN_CD
			 , A.TEL AS TEL, A.EMAIL AS EMAIL
      		 , AG.GRDS_NAME AS GRDS_NAME
		FROM TBL_ADMIN A, TBL_ADM_GRDS AG
		WHERE A.ADM_GRDS_CD = AG.ADM_GRDS_CD(+)
		ORDER BY A.ADMIN_CD
	</select>

	<!-- 총 관리자 회원 수 조회 adminCount() -->
	<select id="adminCount" resultType="java.lang.Integer">
		SELECT COUNT(*) AS COUNT
		FROM TBL_ADMIN
	</select>
	
	<!-- 로그인 -->
	<select id="adminLogin" resultType="java.lang.String">
     	SELECT NAME
		FROM TBL_ADMIN
		WHERE ADMIN_CD=#{admin_cd}
  		  AND PWD=CRYPTPACK.ENCRYPT(#{pwd},#{pwd})
	</select>
	
	<!-- 한명의 회원의 리스트를 뽑아오는 구문 -->
	<select id="adminSearchList" resultType="com.sys.comeit.AdminDTO">
		SELECT ADMIN_CD, ADM_GRDS_CD, NAME, PWD, EMAIL, TEL
		FROM TBL_ADMIN
		WHERE ADMIN_CD = #{admin_cd}
	</select>
	
	<insert id="adminAdd" >
		INSERT INTO TBL_ADMIN(ADMIN_CD, ADM_GRDS_CD, NAME, PWD, EMAIL, TEL)
		VALUES('ADM'||SEQ_ADMIN.NEXTVAL ,'ADMG1002', #{name}, '1234' ,#{email}, #{tel})
		
	</insert>
	
	<update id="adminModify">
		UPDATE TBL_ADMIN
		SET PWD= CRYPTPACK.ENCRYPT(#{pwd},#{pwd}) , TEL=#{tel} , EMAIL= #{email}
		WHERE ADMIN_CD = #{admin_cd}
	</update>
	
	<delete id="adminDelete">
		DELETE
		FROM TBL_ADMIN
		WHERE ADMIN_CD = #{admin_cd}
	</delete>
	
	<select id="banList" resultType="com.sys.comeit.BanDTO">
		SELECT NB.LNGG_BAN_CD AS LNGG_BAN_CD, NB.BAN AS BAN, AD.NAME AS NAME, NB.CRT_DATE AS CRT_DATE
		FROM TBL_LNGG_BAN NB, TBL_ADMIN AD
		WHERE NB.ADMIN_CD = AD.ADMIN_CD(+)
	</select>
	
	<insert id="banAdd" >
		INSERT INTO TBL_LNGG_BAN(LNGG_BAN_CD, ADMIN_CD, BAN, CRT_DATE)
		VALUES('LNGBN'||SEQ_LNGG_BAN.NEXTVAL, #{admin_cd}, #{ban}, SYSDATE)
	</insert>
	
	<delete id="banDelete">
		DELETE
		FROM TBL_LNGG_BAN
		WHERE LNGG_BAN_CD=#{lngg_ban_cd, jdbcType=VARCHAR}
	</delete>
	
</mapper>